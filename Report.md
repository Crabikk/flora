# Проектная работа по дисциплине «Базе данных».
## Этап 1: Разработка даталогической модели базы данных
Описание структуры базы данных
База данных предназначена для хранения информации о растениях, их экологических нишах, условиях выращивания, полезных свойствах и информации о сборе урожая. 
Таблицы и их описание:
1.	Plants: Хранит информацию о растениях, включая их название, научную классификацию, тип, семейство и описание.
2.	Habitats: Хранит информацию о различных экологических нишах, в которых могут расти растения.
3.	Plant_Habitats: Связывает растения с их экологическими нишами, позволяя указать дополнительные заметки и статус активности.
4.	Growing_Conditions: Хранит условия выращивания растений, такие как уровень освещения, влажность и температура.
5.	Benefits: Хранит информацию о полезных свойствах растений.
6.	Harvest_Info: Хранит информацию о времени сбора урожая и методах сбора.

Ограничения:
- Plants: Уникальное имя растения (plant_name), уникальное научное название (scientific_name).
- Habitats: Уникальное название экологической ниши (habitat_name).
- Growing_Conditions: Температура ограничена диапазоном от -50 до 50 градусов.
- Plant_Habitats: Связь с таблицами Plants и Habitats через внешние ключи.
- Benefits и Harvest_Info: Связь с таблицей Plants через внешние ключи с поддержкой каскадного удаления.

Автоматически вычисляемое поле:
В таблице Plant_Habitats можно добавить поле total_plants, которое будет автоматически вычисляться с помощью триггера. Это поле будет показывать количество растений, связанных с конкретной экологической нишей.

Триггер:
```sql
CREATE OR REPLACE FUNCTION update_total_plants() RETURNS TRIGGER AS $$
BEGIN
    UPDATE Habitats h
    SET total_plants = (
        SELECT COUNT(*)
        FROM Plant_Habitats ph
        WHERE ph.habitat_id = h.ID
    )
    WHERE h.ID = NEW.habitat_id;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_update_total_plants
AFTER INSERT OR UPDATE OR DELETE ON Plant_Habitats
FOR EACH ROW EXECUTE FUNCTION update_total_plants();```

